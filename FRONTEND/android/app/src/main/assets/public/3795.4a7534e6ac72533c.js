"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3795],{3795:(m,g,s)=>{s.r(g),s.d(g,{HistorialAsistenciaComponent:()=>i});var l=s(8434),e=s(3092),p=s(33),t=s(1360),d=s(9484);function v(n,o){1&n&&(t.j41(0,"div",5),t.nrm(1,"ion-spinner"),t.k0s())}function r(n,o){if(1&n&&(t.j41(0,"ion-item")(1,"ion-label")(2,"h2"),t.EFF(3),t.k0s(),t.j41(4,"p"),t.EFF(5),t.nI1(6,"date"),t.k0s()()()),2&n){const c=o.$implicit;t.R7$(3),t.SpI("Evento ID: ",c.eventoId,""),t.R7$(2),t.SpI("Fecha: ",t.i5U(6,2,c.fechaAsistencia,"dd/MM/yyyy HH:mm"),"")}}function h(n,o){if(1&n&&(t.j41(0,"ion-card")(1,"ion-list"),t.DNE(2,r,7,5,"ion-item",6),t.k0s()()),2&n){const c=t.XpG();t.R7$(2),t.Y8G("ngForOf",c.asistencias)}}function E(n,o){1&n&&(t.j41(0,"div",7)(1,"ion-text",8),t.EFF(2," No hay registros de asistencia. "),t.k0s()())}let i=(()=>{var n;class o{constructor(a){this.eventosService=a,this.asistencias=[],this.cargando=!0}ngOnInit(){this.eventosService.obtenerHistorialAsistencia().subscribe({next:a=>{this.asistencias=a,this.cargando=!1},error:a=>{console.error("Error al cargar historial:",a),this.cargando=!1}})}}return(n=o).\u0275fac=function(a){return new(a||n)(t.rXU(d.c))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-historial-asistencia"]],decls:10,vars:3,consts:[["slot","start"],["defaultHref","/eventos/lista"],["class","ion-padding",4,"ngIf"],[4,"ngIf"],["class","ion-text-center ion-padding",4,"ngIf"],[1,"ion-padding"],[4,"ngFor","ngForOf"],[1,"ion-text-center","ion-padding"],["color","medium"]],template:function(a,_){1&a&&(t.j41(0,"ion-content")(1,"ion-header")(2,"ion-toolbar")(3,"ion-buttons",0),t.nrm(4,"ion-back-button",1),t.k0s(),t.j41(5,"ion-title"),t.EFF(6,"Historial de Asistencia"),t.k0s()()(),t.DNE(7,v,2,0,"div",2)(8,h,3,1,"ion-card",3)(9,E,3,0,"div",4),t.k0s()),2&a&&(t.R7$(7),t.Y8G("ngIf",_.cargando),t.R7$(),t.Y8G("ngIf",!_.cargando&&_.asistencias.length>0),t.R7$(),t.Y8G("ngIf",!_.cargando&&!_.asistencias.length))},dependencies:[l.MD,l.Sq,l.bT,l.vh,e.bv,e.QW,e.b_,e.W9,e.eU,e.uz,e.he,e.nf,e.w2,e.IO,e.BC,e.ai,e.el,p.iI],styles:["ion-list[_ngcontent-%COMP%]{margin:16px 0}ion-item[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px;--padding-top: 12px;--padding-bottom: 12px;margin:8px 0;border-radius:8px;--background: var(--ion-color-light)}ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:600;margin-bottom:4px}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:.9em;margin:2px 0}.ion-text-center[_ngcontent-%COMP%]{text-align:center}"]}),o})()},9484:(m,g,s)=>{s.d(g,{c:()=>v});var l=s(7468),e=s(5312),p=s(6354),t=s(1360),d=s(3165);let v=(()=>{var r;class h{constructor(i){this.http=i,this.apiUrl=`${e.c.apiUrl}/api/Eventos`}getEventos(){return this.http.get(this.apiUrl)}getEvento(i){return this.http.get(`${this.apiUrl}/${i}`).pipe((0,p.T)(n=>n.evento))}crearEvento(i){return this.http.post(this.apiUrl,i)}actualizarEvento(i,n){return this.http.put(`${this.apiUrl}/${i}`,n)}eliminarEvento(i){return this.http.post(`${this.apiUrl}/${i}/eliminar`,{})}cancelarEvento(i){return this.http.post(`${this.apiUrl}/${i}/cancelar`,{})}registrarAsistencia(i,n=!1){const o={codigoQr:n?i:null,codigoNumerico:n?null:i};return console.log("Payload enviado al backend:",JSON.stringify(o,null,2)),this.http.post(`${this.apiUrl}/asistencia`,o)}obtenerAsistentes(i){return this.http.get(`${this.apiUrl}/${i}/asistentes`).pipe((0,p.T)(n=>n.asistentes))}obtenerHistorialAsistencia(){return this.http.get(`${this.apiUrl}/historial`)}generarReporteAsistencia(i,n){return this.http.get(`${this.apiUrl}/reporte`,{params:{fechaInicio:i.toISOString(),fechaFin:n.toISOString()}})}generarReporteAsistenciaPorEventoId(i){return(0,l.p)({evento:this.getEvento(i),asistentes:this.obtenerAsistentes(i)}).pipe((0,p.T)(n=>({evento:n.evento,asistentes:n.asistentes,totalAsistentes:n.asistentes.length})))}}return(r=h).\u0275fac=function(i){return new(i||r)(t.KVO(d.Qq))},r.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"}),h})()}}]);