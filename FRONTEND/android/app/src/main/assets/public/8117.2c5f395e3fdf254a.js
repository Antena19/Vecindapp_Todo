"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8117],{8117:(C,g,a)=>{a.r(g),a.d(g,{DetalleAsistentesComponent:()=>i});var v=a(467),_=a(8434),o=a(3092),t=a(1360),d=a(333),u=a(9484);function c(s,p){1&s&&(t.j41(0,"div",6),t.nrm(1,"ion-spinner",7),t.EFF(2," Cargando asistentes... "),t.k0s())}function h(s,p){1&s&&(t.j41(0,"ion-card")(1,"ion-card-content")(2,"p"),t.EFF(3,"No hay asistentes registrados para este evento."),t.k0s()()())}function E(s,p){if(1&s&&(t.j41(0,"ion-item")(1,"ion-label")(2,"h2"),t.EFF(3),t.k0s(),t.j41(4,"p"),t.EFF(5),t.k0s(),t.j41(6,"p"),t.EFF(7),t.nI1(8,"date"),t.k0s()()()),2&s){const l=p.$implicit;t.R7$(3),t.Lme("",l.nombre," ",l.apellido,""),t.R7$(2),t.SpI("RUT: ",l.usuarioRut,""),t.R7$(2),t.SpI("Registrado el: ",t.i5U(8,4,l.fechaAsistencia,"dd/MM/yyyy HH:mm"),"")}}function e(s,p){if(1&s&&(t.j41(0,"ion-list"),t.DNE(1,E,9,7,"ion-item",8),t.k0s()),2&s){const l=t.XpG();t.R7$(),t.Y8G("ngForOf",l.asistentes)}}let i=(()=>{var s;class p{constructor(r,n,m,O){this.route=r,this.router=n,this.eventosService=m,this.toastController=O,this.asistentes=[],this.cargando=!0}ngOnInit(){console.log("Iniciando componente de asistentes"),this.route.paramMap.subscribe(r=>{const n=r.get("id");console.log("ID del evento recibido:",n),n?(this.eventoId=+n,console.log("Cargando asistentes para el evento:",this.eventoId),this.cargarAsistentes(this.eventoId)):(console.error("No se proporcion\xf3 ID de evento"),this.presentToast("ID de evento no proporcionado.","danger"),this.router.navigate(["/eventos/lista"]))})}cargarAsistentes(r){console.log("Iniciando carga de asistentes para evento:",r),this.cargando=!0,this.eventosService.obtenerAsistentes(r).subscribe({next:n=>{console.log("Asistentes recibidos:",n),this.asistentes=n,this.cargando=!1},error:n=>{console.error("Error al cargar asistentes:",n),this.presentToast("Error al cargar la lista de asistentes.","danger"),this.cargando=!1,this.asistentes=[]}})}presentToast(r,n){var m=this;return(0,v.A)(function*(){(yield m.toastController.create({message:r,duration:2e3,color:n})).present()})()}volverADetalleEvento(){this.router.navigate(["/eventos/detalle",this.eventoId])}}return(s=p).\u0275fac=function(r){return new(r||s)(t.rXU(d.nX),t.rXU(d.Ix),t.rXU(u.c),t.rXU(o.K_))},s.\u0275cmp=t.VBU({type:s,selectors:[["app-detalle-asistentes"]],decls:10,vars:6,consts:[["color","secondary"],["slot","start"],[3,"defaultHref"],[1,"ion-padding"],["class","ion-padding ion-text-center",4,"ngIf"],[4,"ngIf"],[1,"ion-padding","ion-text-center"],["name","crescent"],[4,"ngFor","ngForOf"]],template:function(r,n){1&r&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t.nrm(3,"ion-back-button",2),t.k0s(),t.j41(4,"ion-title"),t.EFF(5,"Asistentes del Evento"),t.k0s()()(),t.j41(6,"ion-content",3),t.DNE(7,c,3,0,"div",4)(8,h,4,0,"ion-card",5)(9,e,2,1,"ion-list",5),t.k0s()),2&r&&(t.R7$(3),t.Y8G("defaultHref","/eventos/detalle/"+n.eventoId),t.R7$(3),t.xc7("--background","var(--ion-color-light)"),t.R7$(),t.Y8G("ngIf",n.cargando),t.R7$(),t.Y8G("ngIf",!n.cargando&&0===n.asistentes.length),t.R7$(),t.Y8G("ngIf",!n.cargando&&n.asistentes.length>0))},dependencies:[_.MD,_.Sq,_.bT,_.vh,o.bv,o.QW,o.b_,o.I9,o.W9,o.eU,o.uz,o.he,o.nf,o.w2,o.BC,o.ai,o.el],styles:["ion-header[_ngcontent-%COMP%]{--background: var(--ion-color-secondary)}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: var(--ion-color-secondary)}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{color:#fff;font-weight:700}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-back-button[_ngcontent-%COMP%]{--color: white}ion-content[_ngcontent-%COMP%]{--background: var(--ion-color-light)}ion-card[_ngcontent-%COMP%]{margin-top:20px;box-shadow:0 4px 12px #0000001a;border-radius:8px}ion-spinner[_ngcontent-%COMP%]{margin-right:10px}ion-list[_ngcontent-%COMP%]{background:transparent}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: white;margin-bottom:8px;border-radius:8px;box-shadow:0 2px 5px #0000000d}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:700;color:var(--ion-color-primary);margin-bottom:5px}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;font-size:.9em}"]}),p})()},9484:(C,g,a)=>{a.d(g,{c:()=>u});var v=a(7468),_=a(5312),o=a(6354),t=a(1360),d=a(3165);let u=(()=>{var c;class h{constructor(e){this.http=e,this.apiUrl=`${_.c.apiUrl}/api/Eventos`}getEventos(){return this.http.get(this.apiUrl)}getEvento(e){return this.http.get(`${this.apiUrl}/${e}`).pipe((0,o.T)(i=>i.evento))}crearEvento(e){return this.http.post(this.apiUrl,e)}actualizarEvento(e,i){return this.http.put(`${this.apiUrl}/${e}`,i)}eliminarEvento(e){return this.http.post(`${this.apiUrl}/${e}/eliminar`,{})}cancelarEvento(e){return this.http.post(`${this.apiUrl}/${e}/cancelar`,{})}registrarAsistencia(e,i=!1){const s={codigoQr:i?e:null,codigoNumerico:i?null:e};return console.log("Payload enviado al backend:",JSON.stringify(s,null,2)),this.http.post(`${this.apiUrl}/asistencia`,s)}obtenerAsistentes(e){return this.http.get(`${this.apiUrl}/${e}/asistentes`).pipe((0,o.T)(i=>i.asistentes))}obtenerHistorialAsistencia(){return this.http.get(`${this.apiUrl}/historial`)}generarReporteAsistencia(e,i){return this.http.get(`${this.apiUrl}/reporte`,{params:{fechaInicio:e.toISOString(),fechaFin:i.toISOString()}})}generarReporteAsistenciaPorEventoId(e){return(0,v.p)({evento:this.getEvento(e),asistentes:this.obtenerAsistentes(e)}).pipe((0,o.T)(i=>({evento:i.evento,asistentes:i.asistentes,totalAsistentes:i.asistentes.length})))}}return(c=h).\u0275fac=function(e){return new(e||c)(t.KVO(d.Qq))},c.\u0275prov=t.jDH({token:c,factory:c.\u0275fac,providedIn:"root"}),h})()}}]);