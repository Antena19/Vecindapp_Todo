"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6565],{6565:(m,E,i)=>{i.r(E),i.d(E,{ListaEventosComponent:()=>e});var v=i(8434),r=i(3092),p=i(33),t=i(1360),h=i(333),g=i(9484);const c=n=>({"evento-pasado":n});function _(n,l){if(1&n){const a=t.RV6();t.j41(0,"div")(1,"ion-card",9)(2,"ion-card-header")(3,"ion-card-title"),t.EFF(4),t.k0s()(),t.j41(5,"ion-card-content")(6,"p"),t.nrm(7,"ion-icon",10),t.EFF(8),t.nI1(9,"date"),t.k0s(),t.j41(10,"p"),t.nrm(11,"ion-icon",11),t.EFF(12),t.k0s(),t.j41(13,"p",12),t.EFF(14),t.k0s(),t.j41(15,"ion-badge",13),t.EFF(16),t.k0s(),t.j41(17,"ion-button",14),t.bIt("click",function(){const s=t.eBV(a).$implicit,d=t.XpG();return t.Njj(d.verDetalle(s.id))}),t.nrm(18,"ion-icon",15),t.EFF(19," Ver Detalle "),t.k0s()()()()}if(2&n){const a=l.$implicit,o=t.XpG();t.R7$(),t.Y8G("ngClass",t.eq3(11,c,o.eventoPasado(a))),t.R7$(3),t.JRh(a.titulo),t.R7$(4),t.Lme(" ",t.i5U(9,8,a.fechaEvento,"dd/MM/yyyy")," - ",a.horaEvento," "),t.R7$(4),t.SpI(" ",a.lugar," "),t.R7$(2),t.JRh(a.descripcion),t.R7$(),t.Y8G("color","activo"===a.estado?"success":"medium"),t.R7$(),t.SpI(" ",a.estado," ")}}function u(n,l){1&n&&(t.j41(0,"div",16),t.nrm(1,"ion-icon",17),t.j41(2,"p"),t.EFF(3,"No hay eventos programados"),t.k0s(),t.j41(4,"ion-button",18),t.nrm(5,"ion-icon",6),t.EFF(6," Crear Evento "),t.k0s()())}let e=(()=>{var n;class l{constructor(o,s,d){this.router=o,this.route=s,this.eventosService=d,this.eventos=[]}ngOnInit(){this.cargarEventos()}ionViewWillEnter(){this.cargarEventos()}cargarEventos(){this.eventosService.getEventos().subscribe({next:o=>{console.log("Eventos antes de ordenar:",o),this.eventos=this.ordenarEventos(o),console.log("Eventos despu\xe9s de ordenar:",this.eventos)},error:o=>{console.error("Error al cargar eventos:",o)}})}ordenarEventos(o){return o.sort((s,d)=>{const O=new Date(s.fechaEvento),f=new Date(d.fechaEvento);return O.getTime()-f.getTime()})}eventoPasado(o){return new Date(o.fechaEvento)<new Date}crearEvento(){this.router.navigate(["/eventos/crear"])}verDetalle(o){this.router.navigate(["/eventos/detalle",o])}}return(n=l).\u0275fac=function(o){return new(o||n)(t.rXU(h.Ix),t.rXU(h.nX),t.rXU(g.c))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-lista-eventos"]],decls:14,vars:4,consts:[["color","secondary"],["slot","start"],["defaultHref","/home"],["slot","end"],[1,"ion-padding"],["expand","block","color","primary","routerLink","/eventos/crear",2,"margin-bottom","16px"],["name","add-circle-outline","slot","start"],[4,"ngFor","ngForOf"],["class","ion-padding ion-text-center",4,"ngIf"],[1,"evento-card",3,"ngClass"],["name","calendar-outline"],["name","location-outline"],[1,"descripcion"],[3,"color"],["expand","block","fill","clear","color","primary",3,"click"],["name","eye-outline","slot","start"],[1,"ion-padding","ion-text-center"],["name","calendar-outline",2,"font-size","48px","color","var(--ion-color-medium)"],["routerLink","/eventos/crear"]],template:function(o,s){1&o&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t.nrm(3,"ion-back-button",2),t.k0s(),t.j41(4,"ion-title"),t.EFF(5,"Lista de Eventos"),t.k0s(),t.j41(6,"ion-buttons",3),t.nrm(7,"ion-menu-button"),t.k0s()()(),t.j41(8,"ion-content",4)(9,"ion-button",5),t.nrm(10,"ion-icon",6),t.EFF(11," Crear Evento "),t.k0s(),t.DNE(12,_,20,13,"div",7)(13,u,7,0,"div",8),t.k0s()),2&o&&(t.R7$(8),t.xc7("--background","var(--ion-color-light)"),t.R7$(4),t.Y8G("ngForOf",s.eventos),t.R7$(),t.Y8G("ngIf",0===s.eventos.length))},dependencies:[v.MD,v.YU,v.Sq,v.bT,v.vh,r.bv,r.In,r.Jm,r.QW,r.b_,r.I9,r.ME,r.tN,r.W9,r.eU,r.iq,r.MC,r.BC,r.ai,r.el,r.N7,p.iI,p.Wk],styles:["ion-item[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px;--padding-top: 12px;--padding-bottom: 12px;margin:8px 0;border-radius:8px;--background: var(--ion-color-light)}ion-label[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:600;margin-bottom:4px}ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:.9em;margin:2px 0}.evento-pasado[_ngcontent-%COMP%]{opacity:.7;background-color:var(--ion-color-light-shade)}.evento-pasado[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{color:var(--ion-color-medium)}.evento-pasado[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{color:var(--ion-color-medium)}"]}),l})()},9484:(m,E,i)=>{i.d(E,{c:()=>g});var v=i(7468),r=i(5312),p=i(6354),t=i(1360),h=i(3165);let g=(()=>{var c;class _{constructor(e){this.http=e,this.apiUrl=`${r.c.apiUrl}/api/Eventos`}getEventos(){return this.http.get(this.apiUrl)}getEvento(e){return this.http.get(`${this.apiUrl}/${e}`).pipe((0,p.T)(n=>n.evento))}crearEvento(e){return this.http.post(this.apiUrl,e)}actualizarEvento(e,n){return this.http.put(`${this.apiUrl}/${e}`,n)}eliminarEvento(e){return this.http.post(`${this.apiUrl}/${e}/eliminar`,{})}cancelarEvento(e){return this.http.post(`${this.apiUrl}/${e}/cancelar`,{})}registrarAsistencia(e,n=!1){const l={codigoQr:n?e:null,codigoNumerico:n?null:e};return console.log("Payload enviado al backend:",JSON.stringify(l,null,2)),this.http.post(`${this.apiUrl}/asistencia`,l)}obtenerAsistentes(e){return this.http.get(`${this.apiUrl}/${e}/asistentes`).pipe((0,p.T)(n=>n.asistentes))}obtenerHistorialAsistencia(){return this.http.get(`${this.apiUrl}/historial`)}generarReporteAsistencia(e,n){return this.http.get(`${this.apiUrl}/reporte`,{params:{fechaInicio:e.toISOString(),fechaFin:n.toISOString()}})}generarReporteAsistenciaPorEventoId(e){return(0,v.p)({evento:this.getEvento(e),asistentes:this.obtenerAsistentes(e)}).pipe((0,p.T)(n=>({evento:n.evento,asistentes:n.asistentes,totalAsistentes:n.asistentes.length})))}}return(c=_).\u0275fac=function(e){return new(e||c)(t.KVO(h.Qq))},c.\u0275prov=t.jDH({token:c,factory:c.\u0275fac,providedIn:"root"}),_})()}}]);