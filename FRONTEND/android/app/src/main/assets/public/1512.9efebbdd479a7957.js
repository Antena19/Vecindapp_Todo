"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1512],{1512:(G,v,s)=>{s.r(v),s.d(v,{CrearEventoComponent:()=>$});var g=s(467),c=s(9417),i=s(3092),f=s(8434),t=s(1360),h=s(5312),x=s(3165);let C=(()=>{var n;class a{constructor(o){this.http=o,this.apiUrl=`${h.c.apiUrl}/api/eventos`}obtenerEventos(){return this.http.get(this.apiUrl)}obtenerEvento(o){return this.http.get(`${this.apiUrl}/${o}`)}crearEvento(o){return this.http.post(this.apiUrl,o)}actualizarEvento(o,r){return this.http.put(`${this.apiUrl}/${o}`,r)}eliminarEvento(o){return this.http.delete(`${this.apiUrl}/${o}`)}registrarAsistencia(o){const l={codigoQr:null,codigoNumerico:String(o).trim()};return console.log("Payload enviado al backend:",JSON.stringify(l,null,2)),this.http.post(`${this.apiUrl}/asistencia`,l)}}return(n=a).\u0275fac=function(o){return new(o||n)(t.KVO(x.Qq))},n.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),a})();var E=s(333),_=s(4813);function b(n,a){1&n&&(t.j41(0,"ion-text",6),t.EFF(1," El t\xedtulo es obligatorio "),t.k0s())}function F(n,a){if(1&n&&(t.j41(0,"div",17),t.DNE(1,b,2,0,"ion-text",18),t.k0s()),2&n){let e;const o=t.XpG();t.R7$(),t.Y8G("ngIf",null==(e=o.eventoForm.get("titulo"))||null==e.errors?null:e.errors.required)}}function k(n,a){1&n&&(t.j41(0,"ion-text",6),t.EFF(1," La descripci\xf3n es obligatoria "),t.k0s())}function O(n,a){if(1&n&&(t.j41(0,"div",17),t.DNE(1,k,2,0,"ion-text",18),t.k0s()),2&n){let e;const o=t.XpG();t.R7$(),t.Y8G("ngIf",null==(e=o.eventoForm.get("descripcion"))||null==e.errors?null:e.errors.required)}}function y(n,a){1&n&&(t.j41(0,"ion-text",6),t.EFF(1," La fecha es obligatoria "),t.k0s())}function P(n,a){if(1&n&&(t.j41(0,"div",17),t.DNE(1,y,2,0,"ion-text",18),t.k0s()),2&n){let e;const o=t.XpG();t.R7$(),t.Y8G("ngIf",null==(e=o.eventoForm.get("fechaEvento"))||null==e.errors?null:e.errors.required)}}function M(n,a){1&n&&(t.j41(0,"ion-text",6),t.EFF(1," La hora es obligatoria "),t.k0s())}function j(n,a){if(1&n&&(t.j41(0,"div",17),t.DNE(1,M,2,0,"ion-text",18),t.k0s()),2&n){let e;const o=t.XpG();t.R7$(),t.Y8G("ngIf",null==(e=o.eventoForm.get("horaEvento"))||null==e.errors?null:e.errors.required)}}function N(n,a){1&n&&(t.j41(0,"ion-text",6),t.EFF(1," El lugar es obligatorio "),t.k0s())}function T(n,a){if(1&n&&(t.j41(0,"div",17),t.DNE(1,N,2,0,"ion-text",18),t.k0s()),2&n){let e;const o=t.XpG();t.R7$(),t.Y8G("ngIf",null==(e=o.eventoForm.get("lugar"))||null==e.errors?null:e.errors.required)}}let $=(()=>{var n;class a{constructor(o,r,l,p,u,d){this.fb=o,this.eventosService=r,this.modalController=l,this.toastController=p,this.router=u,this.autenticacionService=d,this.tiposEvento=["Reuni\xf3n","Fiesta","Taller","Otro"],this.eventoForm=this.fb.group({titulo:["",c.k0.required],descripcion:["",c.k0.required],fechaEvento:["",c.k0.required],horaEvento:["",c.k0.required],lugar:["",c.k0.required],notas:[""]})}ngOnInit(){}onSubmit(){var o=this;return(0,g.A)(function*(){if(o.eventoForm.valid){const r=o.autenticacionService.obtenerUsuarioActual(),l=null==r?void 0:r.rut;if(!l)return void(yield o.toastController.create({message:"Error: No se pudo obtener el RUT del usuario logueado. Inicie sesi\xf3n nuevamente.",duration:3e3,color:"danger"})).present();const p={...o.eventoForm.value,directivaRut:l,estado:"activo",codigoQr:"",fechaCreacion:(new Date).toISOString()};o.eventosService.crearEvento(p).subscribe({next:(u=(0,g.A)(function*(){yield(yield o.toastController.create({message:"Evento creado exitosamente",duration:2e3,color:"success",position:"top"})).present(),yield new Promise(m=>setTimeout(m,2e3)),o.router.navigate(["/eventos/lista"],{queryParams:{refresh:(new Date).getTime()}})}),function(){return u.apply(this,arguments)}),error:function(){var u=(0,g.A)(function*(d){console.error("Error al crear el evento:",d),(yield o.toastController.create({message:"Error al crear el evento",duration:2e3,color:"danger",position:"top"})).present()});return function(m){return u.apply(this,arguments)}}()})}var u})()}}return(n=a).\u0275fac=function(o){return new(o||n)(t.rXU(c.ok),t.rXU(C),t.rXU(i.W3),t.rXU(i.K_),t.rXU(E.Ix),t.rXU(_.Z))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-crear-evento"]],decls:55,vars:8,consts:[["color","secondary"],["slot","start"],["defaultHref","/eventos/lista","text",""],[1,"ion-padding"],[3,"ngSubmit","formGroup"],["position","stacked"],["color","danger"],["formControlName","titulo","type","text"],["class","error-container",4,"ngIf"],["formControlName","descripcion","rows","3"],["size","6"],["formControlName","fechaEvento","type","date"],["formControlName","horaEvento","type","time"],["formControlName","lugar","type","text"],["formControlName","notas","rows","2"],[1,"ion-padding-top"],["expand","block","type","submit"],[1,"error-container"],["color","danger",4,"ngIf"]],template:function(o,r){if(1&o&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t.nrm(3,"ion-back-button",2),t.k0s(),t.j41(4,"ion-title"),t.EFF(5,"Crear Evento"),t.k0s()()(),t.j41(6,"ion-content",3)(7,"ion-card")(8,"ion-card-content")(9,"form",4),t.bIt("ngSubmit",function(){return r.onSubmit()}),t.j41(10,"ion-item")(11,"ion-label",5),t.EFF(12,"T\xedtulo "),t.j41(13,"ion-text",6),t.EFF(14,"*"),t.k0s()(),t.nrm(15,"ion-input",7),t.k0s(),t.DNE(16,F,2,1,"div",8),t.j41(17,"ion-item")(18,"ion-label",5),t.EFF(19,"Descripci\xf3n "),t.j41(20,"ion-text",6),t.EFF(21,"*"),t.k0s()(),t.nrm(22,"ion-textarea",9),t.k0s(),t.DNE(23,O,2,1,"div",8),t.j41(24,"ion-row")(25,"ion-col",10)(26,"ion-item")(27,"ion-label",5),t.EFF(28,"Fecha "),t.j41(29,"ion-text",6),t.EFF(30,"*"),t.k0s()(),t.nrm(31,"ion-input",11),t.k0s(),t.DNE(32,P,2,1,"div",8),t.k0s(),t.j41(33,"ion-col",10)(34,"ion-item")(35,"ion-label",5),t.EFF(36,"Hora "),t.j41(37,"ion-text",6),t.EFF(38,"*"),t.k0s()(),t.nrm(39,"ion-input",12),t.k0s(),t.DNE(40,j,2,1,"div",8),t.k0s()(),t.j41(41,"ion-item")(42,"ion-label",5),t.EFF(43,"Lugar "),t.j41(44,"ion-text",6),t.EFF(45,"*"),t.k0s()(),t.nrm(46,"ion-input",13),t.k0s(),t.DNE(47,T,2,1,"div",8),t.j41(48,"ion-item")(49,"ion-label",5),t.EFF(50,"Notas Adicionales"),t.k0s(),t.nrm(51,"ion-textarea",14),t.k0s(),t.j41(52,"div",15)(53,"ion-button",16),t.EFF(54," Crear Evento "),t.k0s()()()()()()),2&o){let l,p,u,d,m;t.R7$(6),t.xc7("--background","var(--ion-color-light)"),t.R7$(3),t.Y8G("formGroup",r.eventoForm),t.R7$(7),t.Y8G("ngIf",(null==(l=r.eventoForm.get("titulo"))?null:l.touched)&&(null==(l=r.eventoForm.get("titulo"))?null:l.invalid)),t.R7$(7),t.Y8G("ngIf",(null==(p=r.eventoForm.get("descripcion"))?null:p.touched)&&(null==(p=r.eventoForm.get("descripcion"))?null:p.invalid)),t.R7$(9),t.Y8G("ngIf",(null==(u=r.eventoForm.get("fechaEvento"))?null:u.touched)&&(null==(u=r.eventoForm.get("fechaEvento"))?null:u.invalid)),t.R7$(8),t.Y8G("ngIf",(null==(d=r.eventoForm.get("horaEvento"))?null:d.touched)&&(null==(d=r.eventoForm.get("horaEvento"))?null:d.invalid)),t.R7$(7),t.Y8G("ngIf",(null==(m=r.eventoForm.get("lugar"))?null:m.touched)&&(null==(m=r.eventoForm.get("lugar"))?null:m.invalid))}},dependencies:[i.bv,i.Jm,i.QW,i.b_,i.I9,i.hU,i.W9,i.eU,i.$w,i.uz,i.he,i.ln,i.IO,i.nc,i.BC,i.ai,i.Gw,i.el,f.MD,f.bT,c.X1,c.qT,c.BC,c.cb,c.j4,c.JD],styles:['@charset "UTF-8";.container[_ngcontent-%COMP%]{padding:2rem;max-width:800px;margin:0 auto}h2[_ngcontent-%COMP%]{margin-bottom:2rem;color:#333}.evento-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.full-width[_ngcontent-%COMP%]{width:100%}.form-row[_ngcontent-%COMP%]{display:flex;gap:1rem}.form-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:2rem}mat-form-field[_ngcontent-%COMP%]{margin-bottom:.5rem}textarea[_ngcontent-%COMP%]{min-height:100px}.error-container[_ngcontent-%COMP%]{padding-left:16px;padding-top:5px;font-size:12px}ion-card[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;border-radius:10px;background-color:var(--ion-color-light);box-shadow:0 4px 12px #0000001a}ion-card-title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:var(--ion-color-secondary)}.ion-padding-top[_ngcontent-%COMP%]{padding-top:20px}ion-button[_ngcontent-%COMP%]{margin:20px 0;--border-radius: 8px;--background: var(--ion-color-primary);--background-activated: var(--ion-color-primary-shade);--color: white;font-weight:500}a[_ngcontent-%COMP%]{color:var(--ion-color-primary);text-decoration:none;font-weight:500}ion-item[_ngcontent-%COMP%]{--background: var(--ion-color-light);margin-bottom:2px;--border-radius: 8px;--color: #222}ion-input[_ngcontent-%COMP%]{--background: #fff;--padding-start: 10px;--padding-end: 10px;border:1.5px solid #bdbdbd;border-radius:5px;margin-bottom:10px;--color: #222;color:#222!important}ion-label[_ngcontent-%COMP%]{font-size:1.1rem!important;font-weight:700!important;margin-bottom:6px!important;color:#222!important;letter-spacing:.2px}  ion-input,   ion-input input,   ion-input .native-input{color:#222!important;font-weight:500!important}  ion-input::part(native){color:#222!important}  input::placeholder{color:#888!important;opacity:1!important}ion-text[color=danger][_ngcontent-%COMP%]{color:var(--ion-color-danger)!important}p[_ngcontent-%COMP%]{color:var(--ion-color-secondary)}ion-content[_ngcontent-%COMP%]{--color: var(--ion-color-secondary)}ion-textarea[_ngcontent-%COMP%]{--background: #fff;--padding-start: 10px;--padding-end: 10px;border:1.5px solid #bdbdbd;border-radius:5px;margin-bottom:10px;--color: #222;color:#222!important}ion-select[_ngcontent-%COMP%]{width:100%;max-width:100%;margin-top:5px}ion-datetime-button[_ngcontent-%COMP%]{--background: #fff;border:1.5px solid #bdbdbd;border-radius:5px;margin-bottom:10px;--color: #222;color:#222!important;--padding-start: 10px;--padding-end: 10px;height:auto;--padding-top: 10px;--padding-bottom: 10px}ion-datetime-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#222!important}ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#222!important}']}),a})()}}]);