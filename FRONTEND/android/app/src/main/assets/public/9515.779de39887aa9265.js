"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9515],{9515:(W,F,u)=>{u.r(F),u.d(F,{RecuperarPasswordComponent:()=>S});var b=u(467),s=u(9417),M=u(33),O=u(8434),i=u(3092),x=u(5312),n=u(1360),w=u(3165),E=u(333);function R(o,l){1&o&&(n.j41(0,"ion-text",28),n.EFF(1," El RUT es obligatorio "),n.k0s())}function k(o,l){1&o&&(n.j41(0,"ion-text",28),n.EFF(1," El RUT debe contener solo n\xfameros "),n.k0s())}function y(o,l){1&o&&(n.j41(0,"ion-text",28),n.EFF(1," El DV es obligatorio "),n.k0s())}function I(o,l){1&o&&(n.j41(0,"ion-text",28),n.EFF(1," DV inv\xe1lido (0-9 o K) "),n.k0s())}function j(o,l){1&o&&(n.j41(0,"ion-text",28),n.EFF(1," RUT inv\xe1lido "),n.k0s())}function T(o,l){if(1&o&&(n.j41(0,"div",26),n.DNE(1,R,2,0,"ion-text",27)(2,k,2,0,"ion-text",27)(3,y,2,0,"ion-text",27)(4,I,2,0,"ion-text",27)(5,j,2,0,"ion-text",27),n.k0s()),2&o){let c,e,t,r,p;const a=n.XpG();n.R7$(),n.Y8G("ngIf",null==(c=a.recuperacionForm.get("rut"))||null==c.errors?null:c.errors.required),n.R7$(),n.Y8G("ngIf",null==(e=a.recuperacionForm.get("rut"))||null==e.errors?null:e.errors.pattern),n.R7$(),n.Y8G("ngIf",null==(t=a.recuperacionForm.get("dv_rut"))||null==t.errors?null:t.errors.required),n.R7$(),n.Y8G("ngIf",null==(r=a.recuperacionForm.get("dv_rut"))||null==r.errors?null:r.errors.pattern),n.R7$(),n.Y8G("ngIf",null==(p=a.recuperacionForm.get("dv_rut"))||null==p.errors?null:p.errors.rutInvalido)}}function D(o,l){1&o&&(n.j41(0,"ion-text",28),n.EFF(1," El nombre completo es obligatorio "),n.k0s())}function A(o,l){1&o&&(n.j41(0,"ion-text",28),n.EFF(1," El nombre completo debe tener al menos 3 caracteres "),n.k0s())}function G(o,l){if(1&o&&(n.j41(0,"div",26),n.DNE(1,D,2,0,"ion-text",27)(2,A,2,0,"ion-text",27),n.k0s()),2&o){let c,e;const t=n.XpG();n.R7$(),n.Y8G("ngIf",null==(c=t.recuperacionForm.get("nombreCompleto"))||null==c.errors?null:c.errors.required),n.R7$(),n.Y8G("ngIf",null==(e=t.recuperacionForm.get("nombreCompleto"))||null==e.errors?null:e.errors.minlength)}}function U(o,l){1&o&&(n.j41(0,"ion-text",28),n.EFF(1," La contrase\xf1a es obligatoria "),n.k0s())}function Y(o,l){1&o&&(n.j41(0,"ion-text",28),n.EFF(1," La contrase\xf1a debe tener al menos 8 caracteres "),n.k0s())}function $(o,l){1&o&&(n.j41(0,"ion-text",28),n.EFF(1," La contrase\xf1a debe incluir may\xfasculas, min\xfasculas, n\xfameros y caracteres especiales "),n.k0s())}function B(o,l){if(1&o&&(n.j41(0,"div",26),n.DNE(1,U,2,0,"ion-text",27)(2,Y,2,0,"ion-text",27)(3,$,2,0,"ion-text",27),n.k0s()),2&o){let c,e,t;const r=n.XpG();n.R7$(),n.Y8G("ngIf",null==(c=r.recuperacionForm.get("password"))||null==c.errors?null:c.errors.required),n.R7$(),n.Y8G("ngIf",null==(e=r.recuperacionForm.get("password"))||null==e.errors?null:e.errors.minlength),n.R7$(),n.Y8G("ngIf",null==(t=r.recuperacionForm.get("password"))||null==t.errors?null:t.errors.pattern)}}function N(o,l){1&o&&(n.j41(0,"div",26)(1,"ion-text",28),n.EFF(2," Las contrase\xf1as no coinciden "),n.k0s()())}function L(o,l){1&o&&n.nrm(0,"ion-spinner",29)}function z(o,l){1&o&&(n.j41(0,"span"),n.EFF(1,"Restablecer contrase\xf1a"),n.k0s())}let S=(()=>{var o;class l{constructor(e,t,r,p,a){this.formBuilder=e,this.http=t,this.router=r,this.alertController=p,this.loadingController=a,this.isSubmitted=!1,this.cargando=!1,this.showPassword=!1}ngOnInit(){this.inicializarFormulario()}inicializarFormulario(){this.recuperacionForm=this.formBuilder.group({rut:["",[s.k0.required,s.k0.pattern(/^\d+$/)]],dv_rut:["",[s.k0.required,s.k0.pattern(/^[0-9kK]$/)]],nombreCompleto:["",[s.k0.required,s.k0.minLength(3)]],password:["",[s.k0.required,s.k0.minLength(8),s.k0.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^\da-zA-Z]).{8,}$/)]],confirmPassword:["",s.k0.required]},{validators:this.passwordMatchValidator})}passwordMatchValidator(e){var t,r;return(null===(t=e.get("password"))||void 0===t?void 0:t.value)===(null===(r=e.get("confirmPassword"))||void 0===r?void 0:r.value)?null:{passwordMismatch:!0}}validarRut(){var e,t;const r=null===(e=this.recuperacionForm.get("rut"))||void 0===e?void 0:e.value,p=null===(t=this.recuperacionForm.get("dv_rut"))||void 0===t?void 0:t.value;if(!r||!p)return;let a=0,_=2,v=r.toString();for(let g=v.length-1;g>=0;g--)a+=parseInt(v.charAt(g))*_,_=7===_?2:_+1;const h=a%11;if((0===h?"0":1===h?"K":(11-h).toString())!==p.toUpperCase()){var d;null===(d=this.recuperacionForm.get("dv_rut"))||void 0===d||d.setErrors({rutInvalido:!0})}else{var C;const g=null===(C=this.recuperacionForm.get("dv_rut"))||void 0===C?void 0:C.errors;var P;g&&g.rutInvalido&&(delete g.rutInvalido,null===(P=this.recuperacionForm.get("dv_rut"))||void 0===P||P.setErrors(0===Object.keys(g).length?null:g))}}recuperarContrasena(){var e=this;return(0,b.A)(function*(){var t,r,p,a;if(e.isSubmitted=!0,e.recuperacionForm.invalid)return;e.cargando=!0;const _=yield e.loadingController.create({message:"Procesando solicitud...",spinner:"crescent"});yield _.present();const v={Rut:parseInt(null===(t=e.recuperacionForm.get("rut"))||void 0===t?void 0:t.value),NombreCompleto:null===(r=e.recuperacionForm.get("nombreCompleto"))||void 0===r?void 0:r.value,NuevaContrasena:null===(p=e.recuperacionForm.get("password"))||void 0===p?void 0:p.value,ConfirmarContrasena:null===(a=e.recuperacionForm.get("confirmPassword"))||void 0===a?void 0:a.value};var h;e.http.post(`${x.c.apiUrl}/api/Autenticacion/recuperar-clave-simple`,v).subscribe({next:(h=(0,b.A)(function*(){e.cargando=!1,yield _.dismiss(),yield(yield e.alertController.create({header:"Contrase\xf1a actualizada",message:"Tu contrase\xf1a ha sido actualizada exitosamente. Ya puedes iniciar sesi\xf3n con tu nueva contrase\xf1a.",buttons:[{text:"Iniciar sesi\xf3n",handler:()=>{e.router.navigate(["/login"])}}]})).present()}),function(){return h.apply(this,arguments)}),error:function(){var h=(0,b.A)(function*(m){e.cargando=!1,yield _.dismiss();let f="Ocurri\xf3 un error al actualizar la contrase\xf1a. Por favor, intenta nuevamente.";if(401===m.status)f="Los datos proporcionados no son correctos. Verifica tu RUT y nombre completo.";else if(400===m.status){var d,C;f=null!==(d=m.error)&&void 0!==d&&null!==(d=d.mensaje)&&void 0!==d&&d.includes("contrase\xf1a")?"La nueva contrase\xf1a no cumple con los requisitos de seguridad.":(null===(C=m.error)||void 0===C?void 0:C.mensaje)||"Datos inv\xe1lidos. Verifica la informaci\xf3n proporcionada."}yield(yield e.alertController.create({header:"Error",message:f,buttons:["Aceptar"]})).present()});return function(f){return h.apply(this,arguments)}}()})})()}onSubmit(){this.recuperarContrasena()}volver(){this.router.navigate(["/login"])}togglePassword(){this.showPassword=!this.showPassword}}return(o=l).\u0275fac=function(e){return new(e||o)(n.rXU(s.ok),n.rXU(w.Qq),n.rXU(E.Ix),n.rXU(i.hG),n.rXU(i.Xi))},o.\u0275cmp=n.VBU({type:o,selectors:[["app-recuperar-password"]],decls:68,vars:13,consts:[["color","secondary"],["slot","start"],["defaultHref","/login","text",""],[1,"ion-padding"],[1,"logo-container","ion-text-center"],[3,"ngSubmit","formGroup"],[1,"ion-text-center"],[1,"input-container","ion-padding-top"],[1,"rut-container"],["type","number","formControlName","rut","inputmode","numeric","placeholder","Ingresa tu RUT",3,"ionBlur"],[1,"rut-separator"],[1,"dv-item"],["type","text","formControlName","dv_rut","maxlength","1","placeholder","DV",3,"ionBlur"],["class","error-container",4,"ngIf"],[1,"input-container"],[1,"input-hint"],["formControlName","nombreCompleto","type","text","placeholder","Ingresa tu nombre completo"],["formControlName","password","placeholder","Ingresa tu nueva contrase\xf1a",3,"type"],["slot","end",1,"password-toggle-icon",3,"click","name"],[1,"password-requirements"],["formControlName","confirmPassword","placeholder","Confirma tu nueva contrase\xf1a",3,"type"],["expand","block","type","submit","color","primary",1,"ion-margin-top",3,"disabled"],["name","circles",4,"ngIf"],[4,"ngIf"],[1,"ion-text-center","ion-padding-top"],["routerLink","/login"],[1,"error-container"],["color","danger",4,"ngIf"],["color","danger"],["name","circles"]],template:function(e,t){if(1&e&&(n.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),n.nrm(3,"ion-back-button",2),n.k0s(),n.j41(4,"ion-title"),n.EFF(5,"VecindApp"),n.k0s()()(),n.j41(6,"ion-content",3),n.nrm(7,"div",4),n.j41(8,"form",5),n.bIt("ngSubmit",function(){return t.onSubmit()}),n.j41(9,"ion-card")(10,"ion-card-content")(11,"ion-card-title",6),n.EFF(12,"Recuperaci\xf3n de contrase\xf1a"),n.k0s(),n.j41(13,"ion-card-subtitle",6),n.EFF(14," Ingresa tu RUT y nombre completo para restablecer tu contrase\xf1a "),n.k0s(),n.j41(15,"div",7)(16,"ion-label"),n.EFF(17,"RUT (sin puntos ni gui\xf3n)"),n.k0s(),n.j41(18,"div",8)(19,"ion-item")(20,"ion-input",9),n.bIt("ionBlur",function(){return t.validarRut()}),n.k0s()(),n.j41(21,"div",10),n.EFF(22,"-"),n.k0s(),n.j41(23,"ion-item",11)(24,"ion-input",12),n.bIt("ionBlur",function(){return t.validarRut()}),n.k0s()()()(),n.DNE(25,T,6,5,"div",13),n.j41(26,"div",14)(27,"ion-label"),n.EFF(28,"Nombre completo"),n.k0s(),n.j41(29,"p",15),n.EFF(30,"Incluye tu nombre, apellido paterno y apellido materno."),n.k0s(),n.j41(31,"ion-item"),n.nrm(32,"ion-input",16),n.k0s()(),n.DNE(33,G,3,2,"div",13),n.j41(34,"div",14)(35,"ion-label"),n.EFF(36,"Nueva contrase\xf1a"),n.k0s(),n.j41(37,"ion-item"),n.nrm(38,"ion-input",17),n.j41(39,"ion-icon",18),n.bIt("click",function(){return t.togglePassword()}),n.k0s()(),n.j41(40,"div",19),n.EFF(41," La contrase\xf1a debe contener: "),n.j41(42,"ul")(43,"li"),n.EFF(44,"Al menos 8 caracteres"),n.k0s(),n.j41(45,"li"),n.EFF(46,"Al menos una letra may\xfascula"),n.k0s(),n.j41(47,"li"),n.EFF(48,"Al menos una letra min\xfascula"),n.k0s(),n.j41(49,"li"),n.EFF(50,"Al menos un n\xfamero"),n.k0s(),n.j41(51,"li"),n.EFF(52,"Al menos un car\xe1cter especial"),n.k0s()()()(),n.DNE(53,B,4,3,"div",13),n.j41(54,"div",14)(55,"ion-label"),n.EFF(56,"Confirmar nueva contrase\xf1a"),n.k0s(),n.j41(57,"ion-item"),n.nrm(58,"ion-input",20),n.k0s()(),n.DNE(59,N,3,0,"div",13),n.j41(60,"ion-button",21),n.DNE(61,L,1,0,"ion-spinner",22)(62,z,2,0,"span",23),n.k0s(),n.j41(63,"div",24)(64,"p"),n.EFF(65,"\xbfRecordaste tu contrase\xf1a? "),n.j41(66,"a",25),n.EFF(67,"Iniciar sesi\xf3n"),n.k0s()()()()()()()),2&e){let r,p,a;n.R7$(6),n.xc7("--background","var(--ion-color-light)"),n.R7$(2),n.Y8G("formGroup",t.recuperacionForm),n.R7$(17),n.Y8G("ngIf",t.isSubmitted&&((null==(r=t.recuperacionForm.get("rut"))?null:r.errors)||(null==(r=t.recuperacionForm.get("dv_rut"))?null:r.errors))),n.R7$(8),n.Y8G("ngIf",t.isSubmitted&&(null==(p=t.recuperacionForm.get("nombreCompleto"))?null:p.errors)),n.R7$(5),n.Y8G("type",t.showPassword?"text":"password"),n.R7$(),n.Y8G("name",t.showPassword?"eye-off-outline":"eye-outline"),n.R7$(14),n.Y8G("ngIf",t.isSubmitted&&(null==(a=t.recuperacionForm.get("password"))?null:a.errors)),n.R7$(5),n.Y8G("type",t.showPassword?"text":"password"),n.R7$(),n.Y8G("ngIf",t.isSubmitted&&(null==t.recuperacionForm.errors?null:t.recuperacionForm.errors.passwordMismatch)),n.R7$(),n.Y8G("disabled",t.recuperacionForm.invalid||t.cargando),n.R7$(),n.Y8G("ngIf",t.cargando),n.R7$(),n.Y8G("ngIf",!t.cargando)}},dependencies:[O.MD,O.bT,s.X1,s.qT,s.BC,s.cb,s.tU,s.j4,s.JD,i.bv,i.Jm,i.QW,i.b_,i.I9,i.HW,i.tN,i.W9,i.eU,i.iq,i.$w,i.uz,i.he,i.w2,i.IO,i.BC,i.ai,i.su,i.Gw,i.el,i.oY,M.iI,M.Wk],styles:[".logo-container[_ngcontent-%COMP%]{padding:2px 0;margin-bottom:2px}.logo-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:22px;font-weight:700;margin-bottom:2px;color:var(--ion-color-primary)}.logo-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;margin:0;color:var(--ion-color-secondary)}ion-card[_ngcontent-%COMP%]{box-shadow:0 8px 16px #0003!important;border-radius:10px;background-color:beige;max-width:600px;margin:0 auto}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: #ffffff;--color: #273746;--padding-start: 0;--inner-padding-end: 0;--padding-end: 0;--inner-padding-start: 10px;--border-width: 0 !important;--border-style: none !important;--border-color: transparent !important;--highlight-color: transparent !important;--highlight-color-focused: transparent !important;--highlight-height: 0 !important;--inner-border-width: 0 !important;--show-full-highlight: 0 !important;--show-inset-highlight: 0 !important;--border-radius: 8px;--min-height: 45px;--ripple-color: transparent;--background-focused: #ffffff;--background-hover: #ffffff;margin-bottom:8px;box-shadow:0 2px 4px #0000001a;border:none!important;outline:none!important;padding:0}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]:before, [_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]:after{display:none!important}[_nghost-%COMP%]   ion-item.item-has-focus[_ngcontent-%COMP%]{--highlight-background: transparent !important;--highlight-color-focused: transparent !important;--background-focused: #ffffff}[_nghost-%COMP%]   ion-item.item-has-value[_ngcontent-%COMP%]{--highlight-background: transparent !important;--background-focused: #ffffff}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   .item-native[_ngcontent-%COMP%]{border:none!important;--inner-border-width: 0 !important;background:transparent!important;padding:0;margin:0}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   .item-native[_ngcontent-%COMP%]:after{display:none!important}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   .item-inner[_ngcontent-%COMP%]{border:none!important;--inner-border-width: 0 !important;padding:0;margin:0}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   .item-inner[_ngcontent-%COMP%]:after{display:none!important}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{--padding-start: 10px;--padding-end: 10px;--padding-top: 8px;--padding-bottom: 8px;--background: transparent;--border-width: 0 !important;--border-style: none !important;--border-color: transparent !important;--highlight-color: transparent !important;--highlight-color-focused: transparent !important;--highlight-height: 0 !important;--inner-border-width: 0 !important;border:none!important;outline:none!important;margin:0}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]:before, [_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]:after{display:none!important}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input.has-focus[_ngcontent-%COMP%]{--highlight-background: transparent !important;--highlight-color-focused: transparent !important}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input.has-focus[_ngcontent-%COMP%]::part(placeholder){opacity:0;transition:opacity .15s ease}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]::part(placeholder){opacity:1;transition:opacity .15s ease}[_nghost-%COMP%]     .item-native, [_nghost-%COMP%]     .item-inner, [_nghost-%COMP%]     .input-wrapper{border:none!important;--inner-border-width: 0 !important;background:transparent!important;padding:0;margin:0}[_nghost-%COMP%]     .item-native:before, [_nghost-%COMP%]     .item-native:after, [_nghost-%COMP%]     .item-inner:before, [_nghost-%COMP%]     .item-inner:after, [_nghost-%COMP%]     .input-wrapper:before, [_nghost-%COMP%]     .input-wrapper:after{display:none!important}[_nghost-%COMP%]     ion-input.native-input{border:none!important;outline:none!important;box-shadow:none!important;padding:0;margin:0}ion-item.item[_ngcontent-%COMP%]{--border-width: 0 !important;--border-style: none !important;--border-color: transparent !important;--highlight-color: transparent !important;--highlight-color-focused: transparent !important;--highlight-height: 0 !important}ion-item[_ngcontent-%COMP%]::part(native){--border-width: 0 !important;--border-style: none !important;--border-color: transparent !important;--highlight-color: transparent !important;--highlight-color-focused: transparent !important;--highlight-height: 0 !important}ion-item[_ngcontent-%COMP%]::part(detail-icon){--border-width: 0 !important;--border-style: none !important;--border-color: transparent !important}ion-item[_ngcontent-%COMP%]::part(internal){--border-width: 0 !important;--border-style: none !important;--border-color: transparent !important}.error-container[_ngcontent-%COMP%]{padding-left:16px;padding-top:5px;font-size:12px;color:var(--ion-color-danger)}.input-hint[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium);margin-top:-5px;margin-bottom:10px;padding-left:10px}.password-requirements[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium);margin-top:5px;padding-left:10px}.password-requirements[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:5px 0 0 15px;padding:0;list-style-type:disc}.password-requirements[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:3px}ion-button[_ngcontent-%COMP%]{margin:20px 0;--border-radius: 8px}a[_ngcontent-%COMP%]{color:var(--ion-color-primary);text-decoration:none;font-weight:500}.rut-container[_ngcontent-%COMP%]{display:flex;align-items:flex-end}.rut-container[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{flex:4}.rut-container[_ngcontent-%COMP%]   .dv-item[_ngcontent-%COMP%]{flex:1;min-width:60px}.rut-container[_ngcontent-%COMP%]   .rut-separator[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:24px;margin:0 8px;padding-bottom:10px;color:var(--ion-color-medium)}.password-toggle-icon[_ngcontent-%COMP%]{font-size:1.5rem;color:#92949c;cursor:pointer;margin-right:8px;padding:0}.password-toggle-icon[_ngcontent-%COMP%]:hover{color:var(--ion-color-primary)}@media (max-width: 576px){.logo-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:22px}.logo-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px}}"]}),l})()}}]);